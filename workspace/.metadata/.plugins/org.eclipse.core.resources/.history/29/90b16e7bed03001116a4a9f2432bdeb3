package main.bancoDeDados;
import java.sql.*;
import java.util.ArrayList;

import main.bean.ClienteBean;


public class ConexaoDao {
	//dados para conexao com o banco VARIAVEIS
	private String nomeDriver = "com.mysql.jdbc.Driver";
	private String url = "jdbc:mysql://localhost:3306/mysql";
	private String user = "root";
	private String senha = "root";
	private Connection conexao;
	
	private boolean conectar(){
			
		try {

			Class.forName(nomeDriver);
			conexao = DriverManager.getConnection(url, user, senha);
			if (conexao != null){
				
				System.out.println("conectado");		
			}
					
		} catch (Exception e) {
			
			e.printStackTrace();
			return false;
		}		
		return true;

	}
	private boolean desconectar(){
		try{			
			conexao.close();
			System.out.println("Desconectado");
			
		}catch( Exception e ){
			e.printStackTrace();
			return false;
		}
		return true;
	}
	
	
	//busca todos usuarios
/*	public ArrayList<ClienteBean> getListaUsuarios(){
ArrayList<ClienteBean> retorno = new ArrayList<ClienteBean>(); 
		
		try{
			conectar();
			
			Statement stm = conexao.createStatement();
			String query = "select * from crud_usuario.tb_usuario";
			
			System.out.println( query );
			
			ResultSet rs = stm.executeQuery(query);
			
			while( rs.next() ){
				retorno.add(
					new ClienteBean(
						rs.getInt( "id_usuario" ), 
						rs.getString( "nome" ), 
						rs.getString( "email" ),
						rs.getString( "senha" ))
					);
			}
			stm.close();
		}catch( SQLException e ){
			e.printStackTrace();
		}finally{
			desconectar();
		}
		
		return retorno;
	}
	
	
*/
	
	
	public boolean save( ClienteBean usuario ){
		if( usuario == null ){
			return false;
		}
		
		String query ;
		
		//se id eh zero, eh uma inclusao
		if( usuario.getCpf()==0 ){
			//insert into tb_usuario values (null,'nome','nome','nome')
			query = "insert into crud_usuario.tb_usuario values(null,'"+
					usuario.getNome()+"','"+usuario.getEmail()+"','"+usuario.getSenha()+"')";
		}else{//se id eh diferente de zero, eh alteracao
			query = "update crud_usuario.tb_usuario set nome = '"+
					usuario.getNome()+"', email='"+usuario.getEmail()+
					"',senha='"+usuario.getSenha()+"' where cpf="+usuario.getCpf();
		}
		System.out.println(query);
		
		//grava no bancos
		conectar();
		try{
			Statement stm = conexao.createStatement();
			stm.executeUpdate( query );
			
			stm.close();
		}catch (Exception e) {
			e.printStackTrace();
			return false;
		}
		desconectar();
		
		
		return true;
	}
	
	//public boolean incluirCliente(){
		//conectar();
		
		
	//return true;
	//}
	//metodo main 
	public static void main(){
	
		ConexaoDao con = new ConexaoDao();
	
		
		
	}

}
